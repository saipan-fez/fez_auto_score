<p align="center">
  <img src="img/icon.png">
</p>

## はじめに
FEZ Auto Scoreは、FEZの戦績結果を自動的に解析・保存するためのツールです。  

解析はFEZの画面を一定間隔でキャプチャ(スクリーンショットを撮影)し、その画像内の数字を解析しています。  
詳細な仕組み・アルゴリズムについては、[こちら](OCR_Algorithm)を参照してください(開発者向け)。

## Download
[ダウンロード先](https://github.com/saipan-fez/fez_auto_score/releases)

上記リンクの `fez_auto_score.zip` からダウンロード可能です。  
**なお、下記の「利用にあたって」「初期設定」は必ず確認してください。**

不具合、新機能の要望やアイディアがありましたら、[issues](https://github.com/saipan-fez/fez_auto_score/issues)または[Twitter](https://twitter.com/saipan_fez)にご連絡ください。

## 利用にあたって
**ご利用は自己責任でお願いします。**  
当ツールの利用により利用者または第三者に生じた損害や不利益トラブルについて、  
作成者はその一切の責任を負いません。

## 初期設定
**<font color="red">下記の設定を必ず行ってください。設定が異なる場合、ツールが正しく動作しません。</font>**  

1. **<u>ウィンドウ色を「通常」に変更する</u>**
    1. クライアントを起動
    2. 「OPTION」ボタンを押下
    3. 「カラー」タブに移動
    4. ウィンドウカラーを「通常」に変更
    5. 「閉じる」ボタンを押下
2. **<u>戦績結果の「詳細表示」をONにする</u>**
    1. 戦績結果画面を表示（通常通りプレイする）
    2. 左下の 「詳細表示」をON にする

## 機能・使い方
### 1. スコア保存
<p align="center">
  <img src="img/accumulate_menu.png">
</p>

ウィンドウ上部が「監視中」となっている状態であれば、自動的にスコアは記録されます。  
記録を停止したい場合は、メニューを開き「監視を停止する」を選択してください。  
反対に再開したい場合は、メニューを開き「監視を開始する」を選択してください。  

> 初回起動時は停止状態のため、手動で開始してください。

### 2. スコアをコピーする
<p align="center">
  <img src="img/clipboad.png">
</p>

戦績の一覧で選択した行のスコアをクリップボードにコピーします。  

1. 戦績の一覧からコピーしたい行を選択する  ※複数行選択はShift/Ctrlキーを押しながら
2. 右クリックする
3. 「コピー(選択行の平均スコア)」または「コピー(選択行の各スコア)」を選択する
4. クリップボードにコピーされます

> 集計対象にチェックが入っていない行は除外されます。  
> なお、テキストの書式は「設定」から変更できます。

### 3. CSV出力
CSV形式で全ての戦績をファイルに出力します。  
出力したファイルはエクセルなど表計算ソフトで表示可能です。  

> CSV出力時は集計対象にチェックが入っていない項目も出力されます。

### 4. 直近のスコアをテキストに出力
新たな戦績を検知した際にスコアをテキストファイルに出力します。  
生放送でスコアを画面に表示したい際などにご使用ください。  

> 生放送で表示する方法は「配信ソフト名+テキストファイル」などで検索して設定してください。  
> なお、テキストの書式は「設定」から変更できます。

### 5. 設定

|項目名|説明|
|:-----|:---|
|戦績画像を自動保存する|新たな戦績を検知した際にスコア画像を保存するかどうか<br>保存先：Picture\fez_screenshotフォルダ|
|直近の戦績をテキストに出力する|新たな戦績を検知した際にテキストで保存するかどうか<br>保存先：Document\fez_auto_score\LatestScore.txt|
|書式 - 選択行の平均スコア|「コピー(選択行の平均スコア)」選択時の書式|
|書式 - 選択行の各スコア|「コピー(選択行の各スコア)」選択時の書式|
|書式 - 直近の戦績をテキストに出力する|LatestScore.txtに書き込む書式|

#### 5.1 書式について
下記の文字はそれぞれ各スコアに置き換えて出力されます。

##### 選択行の平均スコア

|書式|説明|
|:---|:---|
|{戦争数}|平均算出時の戦争数|
|{勝率}|勝利した戦争数のパーセンテージ|
|{平均戦争時間}|戦争時間の平均|
|{平均キル数}|キル数の平均|
|{平均デッド数}|デッド数の平均|
|{平均PC与ダメージ}|PCDの平均|
|{平均PC与ダメージ_K}|PCDの平均（単位:k）|
|{平均建築与ダメージ}|建築与ダメージの平均|
|{平均建築与ダメージ_K}|建築与ダメージの平均（単位:k）|

##### 選択行の各スコア・直近の戦績をテキストに出力する

|書式|説明|
|:---|:---|
|{勝敗}|戦争の勝敗|
|{職業}|職業名|
|{戦争時間}|戦争時間|
|{マップ名}|マップ名|
|{キル数}|キル数|
|{デッド数}|デッド数|
|{PC与ダメージ}|PCD|
|{PC与ダメージ_K}|PCD（単位:k）|
|{建築与ダメージ}|建築与ダメージ|
|{建築与ダメージ_K}|建築与ダメージ（単位:k）|

## FAQ

（のちほど書きます）
